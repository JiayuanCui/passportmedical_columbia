<html>
    <head>
        <title>My Passport</title>
        <script src="https://github.com/virslaan/passportmedical_columbia/blob/main/my_passport.js"></script>
    </head>
    <style>
	    div {
  resize: both;
  overflow: auto;
}
	    
        body {
            background: fixed;
            background-repeat: no-repeat;
            background-size: cover;
            font-family: "Lato";
        }
        h1,h2,h3,h4,h5,p,container {
            box-sizing: auto;
            font-family: sans-serif;
        }
	img{
	    object-fit: "cover";
            width: 400px;
            height: 400px;
            border: "solid 1px #CCC";
		
	    }
       input[type="text"], select, textarea {
    width: 100%;
    padding: 20px;
    border: 1px solid black;
    border-radius: 53px;
    resize: auto;
    font-size: 30px;
}
       label {
    padding: 0px 53px 5px 2px;
    font-family: sans-serif;
}
     
input[type="button"] {
    background-color: rebeccapurple;
    padding: 14px 24px;
    border-radius: 140px;
    font-family: sans-serif;
    font-size: larger;
	color:white
}
      
.container {
  border-radius: 70px;
    background-color: rgba(60,60,60,0.1);
    padding: 126px;
    width: fit-content;
    height: fit-content;
    margin-left: inherit;
    margin-right: auto;
    font-family: sans-serif;
}
        
        #file-ip-1-preview2 {
            object-fit: "contain";
            width: 300px;
            height: 300px;
            borde: "solid 1px #CCC";
        }
        #file-ip-1-preview,tableBanner,tableBanner2 {
            object-fit: "contain";
            width: 400px;
            height: 400px;
            border: "solid 1px #CCC";
        }
        /* Clear floats after the columns */
        .row:after {
            content: "";
            display: table;
            clear: both;
        }
       button {
	       background-color: orange;
    color: white;
    padding: 15px 20px;
    border-radius: 59px;
    cursor: pointer;
    float: left;
    font-family: sans-serif;
    font-size: large;
	    }
      #c1 {
  background-color: darkcyan;
    color: white;
    padding: 16px 20px;
    border-radius: 64px;
    cursor: pointer;
    float: left;
    font-family: sans-serif;
}
    </style>
    <body>
        <div class="container">
            <form>
                <h1 style="font-family: sans-serif;">My Pediatric Cardiology Patient Passport</h1>
                <button onclick="printing()">Download My Medical Passport!</button>
                <button id="c1" onclick="clear_function()">Clear All Records</button>

                <input type="button" value="Save / Update" onClick="saveData()" />
                <br /><br />
                <h3>Who I am:</h3>
                <br />
                <label for="fname">Patient Name:</label><br />
                <input type="text" id="fname" name="fname" required /><br />
                <label for="dob">Date of Birth:</label><br />
                <input style="font-size: xxx-large;font-family: sans-serif;" type="date" id="dob" name="dob" />
                <input type="text" id="age" name="age" readonly/><br />
                
		<h3>My Cardiac History:</h3>
                <label for="carDiag">Cardiac Diagnosis:</label><br />
                <input type="text" id="carDiag" name="carDiag" /><br />
                <label for="pastSur">Past Surgeries:</label><br />
                <input type="text" id="pastSur" name="pastSur" /><br />
                <label for="pastCat">Past Catheterizations:</label><br />
                <input type="text" id="pastCat" name="pastCat" /><br />
                <label for="impDev">Implanted Devices:</label>
                <p>(ICD, Pacemaker, Valve, etc )</p>
                <p>
                    <br />
                    <input type="text" id="impDev" name="impDev" />
                </p>
                <h3>Other Important Information:</h3>
                <h4>Baseline Vital Signs</h4>
                <li>
                    <label for="oxy">Oxygen Saturation:</label><br />
                    <input type="text" id="oxy" name="oxy" />
                </li>
                <li>
                    <label for="resting">Resting Heart Rate:</label><br />
                    <input type="text" id="resting" name="resting" />
                </li>
                <li>
                    <label for="bp">Blood Pressure:</label><br/>
                    <input type="text" id="bp" name="bp" /><br />
                    <br />
                    <label for="carDiag">Cardiac Diagnosis:</label><br/>
                    <input type="text" id="carDiag" name="carDiag" /><br />
                    <h4>Most Recent</h4>
                </li>
                <li>
                    <label for="hemo">Hemoglobin/Hematocrit:</label><br/>
                    <input type="text" id="hemo" name="hemo" /><br />
                </li>
                <li>
                    <label for="inr">Target INR (if on anticoagulants):</label><br/>
                    <input type="text" id="inr" name="inr" /><br />
                </li>
                <li>
                    <label for="iep">Need for Infective Endocaditis:</label><br />
                    <input type="radio" id="yes" name="iep" value="Yes" />Yes<br />
                    <input type="radio" id="no" name="iep" value="No" />No<br />
                    <label for="par">Physical Activity Restrictions:</label><br />
                    <input type="text" id="par" name="par" /><br />
                    <label for="genetic">Genetic Testing:(Special Instrcutions)</label><br />
                    <input type="text" id="genetic" name="genetic" /><br />
                </li>
                <h3>My Medical History</h3>
                <label for="mmi">Other Major Medical Issues:</label><br />
                <input type="text" id="mmi" name="mmi" /><br />
                <label for="cm">Current Medications:</label><br />
                <input type="text" id="cm" name="cm" /><br />
                <label for="aller">Allergies:</label><br />
                <input type="text" id="aller" name="aller" /><br />
                <h3>If you have any questions, please call:</h3>
                <label for="mpc">My Pediatric Cardiologist:</label><br />
                <input type="text" id="mpc" name="mpc" /><br />
                <h3>Other Members of My Care Team:</h3>
                <label for="mpp">My Primary Pediatrician:</label><br />
                <input type="text" id="mpp" name="mpp" /><br />
                <h3>My Contact Information:</h3>
                <label for="mci">My Guardian:</label><br />
                <input type="text" id="mci" name="mci" /><br />
                <b> Directive</b>
                <br />
                <p>
                    In case of emergency, if possible, please transport me to:
                </p>
                <br />
                Columbia University Medical Center <br />
                Morgan Stanley Children's Hospital <br />
                3959 Broadway <br />
                New York, NY 10032<br />
                <input type="button" value="Save" onClick="saveData()" />
                <button onclick="printing()">Download My Medical Passport!</button>
           </form>
		
                <img src="" id="tableBanner" />
		    <br/>
                 <img src="" id="tableBanner2" />
               
		    <script>
                                   window.onload = function() {
                                    user=  window.localStorage.getItem('fname');
                                                    alert("Hi " + user);
                                              fname= window.localStorage.getItem("fname", fname);
                                           dob = window.localStorage.getItem("dob", dob);
                                            carDiag = window.localStorage.getItem("carDiag", carDiag);
                                            pastSur = window.localStorage.getItem("pastSur", pastSur);
                                            pastCat = window.localStorage.getItem("pastCat", pastCat);
                                            impDev = window.localStorage.getItem("impDev", impDev);
                                            oxy = window.localStorage.getItem("oxy", oxy);
                                            resting = window.localStorage.getItem("resting", resting);
                                            bp = window.localStorage.getItem("bp", bp);
                                            hemo = window.localStorage.getItem("hemo", hemo);
                                            inr = window.localStorage.getItem("inr", inr);
                                            par = window.localStorage.getItem("par", par);
                                            genetic = window.localStorage.getItem("genetic", genetic);
                                            mmi = window.localStorage.getItem("mmi", mmi);
                                            cm = window.localStorage.getItem("cm", cm);
                                            aller = window.localStorage.getItem("aller", aller);
                                            mpc = window.localStorage.getItem("mpc", mpc);
                                            mpp = window.localStorage.getItem("mpp", mpp);
                                            mci = window.localStorage.getItem("mci", mci);

					    today = new Date()
					    document.getElementById("age").value = _calcAge(today,dob)
                                    document.getElementById("fname").value = (window.localStorage.getItem("fname", fname)).toString();
                                    document.getElementById("dob").value = dob.toString();
                                    document.getElementById("carDiag").value = carDiag.toString();
                                    document.getElementById("pastSur").value = pastSur.toString();
                                   document.getElementById("pastCat").value=pastCat.toString();
                                   document.getElementById("impDev").value=impDev.toString();
                                    document.getElementById("oxy").value=oxy.toString();
                                    document.getElementById("resting").value=resting.toString();
                                   document.getElementById("bp").value=bp.toString();
                                    document.getElementById("hemo").value=hemo.toString();
                                    document.getElementById("inr").value=inr.toString();
                                    document.getElementById("par").value=par.toString();
                                    document.getElementById("genetic").value=genetic.toString();
                                    document.getElementById("mmi").value=mmi.toString();
                                    document.getElementById("cm").value=cm.toString();
                                    document.getElementById("aller").value=aller.toString();
                                   document.getElementById("mpc").value=mpc.toString();
                                    document.getElementById("mpp").value=mpp.toString();
                                    document.getElementById("mci").value=mci.toString();
                                   alert("Save the page for printing!");
                                       
                                   var dataImage = localStorage.getItem('imgData');
				    bannerImg = document.getElementById('tableBanner');
					bannerImg.src = "data:image/png;base64," + dataImage;
					   
					   var dataImage2 = localStorage.getItem('imgData2');
						bannerImg2 = document.getElementById('tableBanner2');
							bannerImg2.src = "data:image/png;base64," + dataImage2;
                                   };
                                   function clear_function()
                                   {
                                    var Val = confirm("Do you want delete all information on this device ?");
                                    if( Val == true ){
                                       localStorage.clear();

                                      document.write (" Successfully Cleared!");
                                      alert('Info is locally saved for yo');
                                       printing();
                                      return true;
                                   }
                                   else{

                                      document.write ("Try Again Later!");
                                      return false;
                                   }
                                }

			       //Calculates age from given Birth Date in the form//
       function _calcAge(birthDate, givenDate) {
        givenDate = new Date(today);
        var dt1 = document.getElementById('date').value;
        var birthDate = new Date(dt1);
        var years = (givenDate.getFullYear() - birthDate.getFullYear());

        if (givenDate.getMonth() < birthDate.getMonth() ||givenDate.getMonth() == birthDate.getMonth() && givenDate.getDate() < birthDate.getDate()) {
            years--;
        }

        return years;
    }
			    
			    
			    
			    
                                   function printing()
                                   {
					   //document.write("<style>body { background: url("https://media.istockphoto.com/vectors/profile-verification-check-marks-icons-vector-illustration-vector-id1313547780?k=20&m=1313547780&s=612x612&w=0&h=dpYT_kesPq9p3wHVyXTXdMy71_o-YczCkG0zMrsNfiA="; background-repeat: no-repeat; background-size: cover; font-family: "Lato" ;} </style> ");
					        document.write("<body>");
                                           document.write("<h1>My Pediatric Cardiology Patient Passport</h1>");
					        
					   document.write("<h3><u>Who I Am:</u><h3/><br/>");
                                        
					   document.write("<br/>Patient Name: ", fname);
					   //document.write("</p><br>");
	                                   document.write("<p><b>Date of Birth:</b>", dob);
	                                   document.write("</p>");
					   document.write("<h3><u>My Cardiac History:</u><h3/>");
                                           document.write("<p><b>Cardiac Diagnosis: </b>", carDiag);
					   document.write("</p><br>");
	                                   document.write("<p><b>Past Surgeries:</b> ", pastSur);
					   document.write("</p><br>");
	                                   document.write("<p><b>Past Catheterizations: </b>", pastCat);
					   document.write("</p><br>");
	                                   document.write("<p><b>Implanted Devices:</b> ", impDev);
					   document.write("</p><br>");
					   document.write("(ICD, Pacemaker, Valve, etc.)");
					        
					   document.write("<br>");
	                                   document.write("<h3><u>Other Important Information:</u><h3/>");
 			                   document.write("<h4>Baseline Vital Signs:</h4>");
	                                        document.write("<br/><li>Oxygen Saturation:", oxy); 
					        document.write("</li>");
	                                        document.write("<br/><li>Resting Heart Rate: ", resting);
					        document.write("</li>");
	                                        document.write("<br/><li>Blood Pressure: ", bp);
					        document.write("</li>");
	                                        document.write("<h4>Most Recent</h4>");
	                                      
	                                        document.write("<br/>Hemoglobin/Hematocrit: ", hemo);
	                                        document.write("<br/>Target INR (if no anticoagulants): ", inr);
	                                        //document.write("<br/>Need for Infective Endocaditis Prophylaxis: ", io);
	                                        document.write("<br/>Physical Activity Restrictions: ", par);
	                                        document.write("<br/>Genetic Testing (Special Instructions):", genetic);
	                                        document.write("<h3><u>My Medical History:</u><h3/>");
 			                 	document.write("<br/>Other Major Medical Issues:", mmi);
	                                        document.write("<br/>Current Medications:", cm);
	                                        document.write("<br/>Allergies:", aller);
	                                        document.write("<h3><u>If you have any questions, please call:</u><h3>");
	                                        document.write("<h3><u>Other Members of my Care Team:</u></h3>");
	                                      
	                                        document.write("<br/>My Primary Pediatrician:", mpc);
	                                        document.write("<h3><u>My Contact Information:</u></h3>");
	                                          
					        document.write("<br/>My Guardian: ", mci);
	                                        
						document.write("<h4>Directive</h4>");
					        document.write("<p>In case of emergency, if possible, please transport me to:<br/>Columbia University Medical Center<br/>Morgan Stanley Children's Hospital<br/>3959 Broadway<br/>New York, NY 10032</p>");
	                                   
					   
					 
	                                            document.write("</body>");
 
                                                document.write("");
                                       
 
                                       
                                       window.print();
                                   }

                                    function getBase64Image(img) 
                                    {
                                    var canvas = document.createElement("canvas");
                                    canvas.width = img.width;
                                    canvas.height = img.height;

                                    var ctx = canvas.getContext("2d");
                                    ctx.drawImage(img, 0, 0);

                                    var dataURL = canvas.toDataURL("image/png");

                                    return dataURL.replace(/^data:image\/(png|jpg);base64,/, "");
                                    }



                                   function showPreview(event) {
                                    if (event.target.files.length > 0) {
                                        var src = URL.createObjectURL(event.target.files[0]);
                                        var preview = document.getElementById("file-ip-1-preview");
                                        preview.src = src;
                                        preview.style.display = "block";
                                    }
                                   }
                                   function showPreview2(event) {
                                    if (event.target.files.length > 0) {
                                        var src = URL.createObjectURL(event.target.files[0]);
                                        var preview = document.getElementById("file-ip-1-preview2");
                                        preview.src = src;
                                        preview.style.display = "block";
                                           }
                                   }
                                   function ko() {
                                    console.log("Preparing to Send...");
                                   }
                                   function saveData() {
                                    let name, email, psw;
                                    fname = document.getElementById("fname").value;
                                    dob = document.getElementById("dob").value;
                                    carDiag = document.getElementById("carDiag").value;
                                    pastSur = document.getElementById("pastSur").value;
                                    pastCat = document.getElementById("pastCat").value;
                                    impDev = document.getElementById("impDev").value;
                                    oxy = document.getElementById("oxy").value;
                                    resting = document.getElementById("resting").value;
                                    bp = document.getElementById("bp").value;
                                    hemo = document.getElementById("hemo").value;
                                    inr = document.getElementById("inr").value;
                                    iep = document.getElementById("yes").value;
                                    io = document.getElementById("no").value;
                                    par = document.getElementById("par").value;
                                    genetic = document.getElementById("genetic").value;
                                    mmi = document.getElementById("mmi").value;
                                    cm = document.getElementById("cm").value;
                                    aller = document.getElementById("aller").value;
                                    mpc = document.getElementById("mpc").value;
                                    mpp = document.getElementById("mpp").value;
                                    mci = document.getElementById("mci").value;

                                    localStorage.setItem("fname", fname);
                                    localStorage.setItem("dob", dob);
                                    localStorage.setItem("carDiag", carDiag);
                                    localStorage.setItem("pastSur", pastSur);
                                    localStorage.setItem("pastCat", pastCat);
                                    localStorage.setItem("impDev", impDev);
                                    localStorage.setItem("oxy", oxy);
                                    localStorage.setItem("resting", resting);
                                    localStorage.setItem("bp", bp);
                                    localStorage.setItem("hemo", hemo);
                                    localStorage.setItem("inr", inr);
                                    localStorage.setItem("iep", iep);
                                    localStorage.setItem("io", io);
                                    localStorage.setItem("par", par);
                                    localStorage.setItem("genetic", genetic);
                                    localStorage.setItem("mmi", mmi);
                                    localStorage.setItem("cm", cm);
                                    localStorage.setItem("aller", aller);
                                    localStorage.setItem("mpc", mpc);
                                    localStorage.setItem("mpp", mpp);
                                    localStorage.setItem("mci", mci);
                                       
                                       
                                    bannerImage = document.getElementById('file-ip-1-preview');
                                    imgData = getBase64Image(bannerImage);
                                    localStorage.setItem("imgData", imgData);
                                    bannerImage2 = document.getElementById('file-ip-1-preview2');
                                    imgData2 = getBase64Image(bannerImage2);
                                    localStorage.setItem("imgData2", imgData2);
                                    
					   alert('Info is locally saved for you! Please download your PDF');

                                   }
                		</script>
                <h3>Cardiac Testing</h3>
                <h5>Most Recent EKG:</h5>
                <label for="file-ip-1">Upload Image</label>
                <input type="file" id="file-ip-1" accept="image/*" onchange="showPreview(event);" />
                <div class="preview">
                    <img id="file-ip-1-preview" />
                </div>
                <h5>Most Recent Echocardiogram:</h5>
                <label for="file-ip-2">Upload Image</label>
                <input type="file" id="file-ip-2" accept="image/*" onchange="showPreview2(event);" />
                <div class="preview2">
                    <img id="file-ip-1-preview2" />
                </div>
                
        </div>
    </body>
</html>
